<!DOCTYPE html>
<html lang="en"><head>
	<meta charset="utf-8">
	<meta name="description" content='X3eRo0&#39;s Blog about Reverse Engineering'>
	<meta name="keywords" content='X3eRo0, Reverse, Reverse Engineering, Crackmes, blog'>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="generator" content="Hugo 0.68.3" />
	<link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="/css/custom.css">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css" integrity="sha256-46qynGAkLSFpVbEBog43gvNhfrOj+BmwXdxFgVK/Kvc=" crossorigin=anonymous>
	<link rel="stylesheet" type="text/css"  href="/css/ui.css">
	<title>Hyperion</title>
	<link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico">
	<nav class="navbar text-center sticky-top bg-white mt-2 mb-1">
		<a href='https://x3ero0.github.io/'><span class="btn btn-sm btn-outline-primary">Home</span></a>
		<a href="/crackmes"><span class="btn btn-sm btn-outline-secondary">Crackmes</span></a>
		<a href="/posts"><span class="btn btn-sm btn-outline-success">Blog</span></a>
		<a href="/tags"><span class="btn btn-sm btn-outline-warning">Tags</span></a>
	</nav>
</head>
<body>
      <div id="content">


	<section class="container text-justified mt-3">
	  <h2 class="text-center mb-4">Hyperion</h2>
	    <div class="text-monospace">
			<h1 id="pwning-pocket-tanks---hyperion-google-ctf-2017-finals">Pwning Pocket Tanks - Hyperion [Google CTF 2017 Finals]</h1>
<hr>
<ul>
<li>Author : <a href="https://gynvael.coldwind.pl/">Gynvael Coldwind</a></li>
<li>Language : C/C++</li>
<li>Upload : May 9th, 2018</li>
<li>Level : I will rate it 8/10</li>
<li>Platform : Server: Linux | Client: Windows/Linux etc.</li>
<li>Files : <a href="https://crackmes.one/crackme/5bc0fe0033c5d4110a29b296">change the link hyperion</a></li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-plaintext" data-lang="plaintext">Desc:
  - It&#39;s 2017, so even single-player games require Internet connection.
</code></pre></div><hr>


<br>

<p>Hyperion was one of the pwn challenges from Google CTF 2017 Finals. One day I randomly asked Gynvael (who is the author of this challenge) to give me some CTF challenges. He gave me 3 Revs and 1 Pwn challenges. In the end i solved 2 Revs and 1 Pwn.  I received these challenges in June 2019, but being a noob i was not able to solve any of them. I solved the 2 Revs (the 3rd Rev is still unsolved and i still have no clue XD) sometime in 2020 but this Pwn (Hyperion) was still remaining. Just recently i decided that i will take a look and i will solve it finally.</p>
<h3 id="first-look">First Look</h3>
<hr>



<div class="center">
  <img
    class="responsive"
    src="/img/hyperion/game.png"
    alt="First look of the Challenge"
    decoding="async"
  />
</div>


<br>

<p>Hyperion is a single player clone of Pocket Tanks, except that it requires internet connection even when playing againts a bot. We are given a server binary that runs on Linux and 2 Version of client, one for windows and one for linux. The client binaries requires SDL2 because the game uses SDL for graphics and controls.</p>
<p>The Goal of this challenge is to not only defeat the bot, but to also get a shell on the server. I immediately opened the server binary in IDA Pro.</p>


<br>




<div class="center">
  <img
    class="responsive"
    src="/img/hyperion/main.png"
    alt="main()"
    decoding="async"
  />
</div>


<br>

<p>The challenge pops shell if its running in DEBUG environment with &ldquo;HYPERION_ENV_TEST&rdquo; environment variable set. Game also supports fork server mode and single run mode.</p>
<p>I used the single run mode so that i can the interaction happens through <code>STDIN</code> and <code>STDOUT</code>.</p>
<p><code>socat TCP-LISTEN:1337,reuseaddr,fork exec:./hyperion_server</code></p>
<p>Now we can connect to the challenge server with <code>localhost</code> as IP.</p>
<p><code>./hyperion_client localhost</code></p>
<h3 id="hyperion---lets-play-by-x3ero0">Hyperion - Let&rsquo;s Play by X3eRo0</h3>
<hr>



<div class="center">
  <img
    class="responsive"
    src="/img/hyperion/controls.png"
    alt="Game Controls"
    decoding="async"
  />
</div>


<br>

<p>The game has a map of 640x480 pixels or 38400 bytes. Dirt is represented by <code>1</code> and Air is represented by <code>0</code>. We control the Green Tank and Red Tank is the enemy but Red Tank never misses. We have 3 Weapons as described in the above image.</p>
<ul>
<li>18 Damage, 10 Radius Explosion</li>
<li>0 Damage, 15 Radius Dirt Ball</li>
<li>8 Damage, 20 Radius Explosion (Deletes Dirt in its radius)</li>
</ul>
<p>Here is a small and very bad gameplay.


<br>
</p>



<div class="center">
  <img
    class="responsive"
    src="/img/hyperion/gameplay.gif"
    alt="main()"
    decoding="async"
  />
</div>


<br>

<h3 id="the-reverse-engineering-starts">The Reverse Engineering Starts</h3>
<hr>
<p>Before starting reversing the code i wanted to look at the network traffic, for that i used wireshark and followed the TCP stream for the packet i found related to the challenge.</p>
<p>This is what the server was sending the client upon receiving the connection</p>


<br>




<div class="center">
  <img
    class="responsive"
    src="/img/hyperion/server_data.png"
    alt="main()"
    decoding="async"
  />
</div>


<br>

<p>And this is what the client was send to the server after the player fires a bullet.</p>


<br>




<div class="center">
  <img
    class="responsive"
    src="/img/hyperion/client_data.png"
    alt="main()"
    decoding="async"
  />
</div>


<br>



<link rel="stylesheet" href="/css/styles/ir-black.css">
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


		</div>
	</section>
<div id="disqus_thread" class="container"></div>
<script>
	(function() { 
		var d = document, s = d.createElement('script');
		s.src = 'https://x3ero0-tech.disqus.com/embed.js';
		s.setAttribute('data-timestamp', +new Date());
		(d.head || d.body).appendChild(s);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            


      </div>
  </body><footer>
  <div class="container-fluid bg-dark text-white text-monospace text-center mt-4">
    <small style="color:#ffffff">
    	<b>-=[ </b>
    	<a href="https://youtube.com/pulkitsinghaniapulkittech" style="color:#e6ffff">YouTube</a>
    	<a href="https://www.linkedin.com/in/pulkit-singh-singaria-500a53166/" style="color:#e6ffff">LinkedIn</a>
    	<a href="https://twitter.com/X3eRo0" style="color:#e6ffff">Twitter</a>
    	<a href="https://ctftime.org/user/43759" style="color:#e6ffff">CTFTime</a>
    	<b> ]=-</b>
    </small>
  </div>
</footer></html>
